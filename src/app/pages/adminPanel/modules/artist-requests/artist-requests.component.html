<app-alert></app-alert>

<h4>Artist Requests</h4>

<div class="row">
  <div class="col-md-6 col-xl-3 mb-3">
      <div class="widget-rounded-circle card">
          <div class="card-body">
              <div class="row">
                  <div class="col-6">
                      <div class="avatar-lg rounded-circle d-flex justify-content-center align-items-center">
                          <img src="../../../../../assets/icons/system-pending-line-svgrepo-com.svg" alt="pending" class="top-logo">
                      </div>
                  </div>
                  <div class="col-6">
                      <div class="text-end">
                          <h3 class="text-dark mt-1"><span data-plugin="counterup">{{pendingRequests}}</span></h3>
                          <p class="text-muted mb-1 text-truncate">Pending Requests</p>
                      </div>
                  </div>
              </div> 
          </div>
      </div>
  </div>
  <div class="col-md-6 col-xl-3 mb-3">
    <div class="widget-rounded-circle card">
        <div class="card-body">
            <div class="row">
                <div class="col-6">
                    <div class="avatar-lg rounded-circle d-flex justify-content-center align-items-center">
                        <img src="../../../../../assets/icons/reject-cross-delete-svgrepo-com.svg" alt="rejected" class="top-logo">
                    </div>
                </div>
                <div class="col-6">
                    <div class="text-end">
                        <h3 class="text-dark mt-1"><span data-plugin="counterup">{{rejectedRequests}}</span></h3>
                        <p class="text-muted mb-1 text-truncate">Rejected Requests</p>
                    </div>
                </div>
            </div> 
        </div>
    </div>
</div>
<div class="col-md-6 col-xl-3 mb-3">
  <div class="widget-rounded-circle card">
      <div class="card-body">
          <div class="row">
              <div class="col-6">
                  <div class="avatar-lg rounded-circle d-flex justify-content-center align-items-center">
                      <img src="../../../../../assets/icons/approved-check-mark-svgrepo-com.svg" alt="approved" class="top-logo">
                  </div>
              </div>
              <div class="col-6">
                  <div class="text-end">
                      <h3 class="text-dark mt-1"><span data-plugin="counterup">{{approvedArtists}}</span></h3>
                      <p class="text-muted mb-1 text-truncate">Approved Artists</p>
                  </div>
              </div>
          </div> 
      </div>
  </div>
</div>
</div>

<ul class="nav nav-tabs mt-4" role="tablist" style="width: 100%;">
    <li class="nav-item" role="presentation">
        <a class="nav-link active" data-bs-toggle="tab" href="#home" aria-selected="true" role="tab">Pending
            Requests</a>

    </li>
    <li class="nav-item" role="presentation">
        <a class="nav-link" data-bs-toggle="tab" href="#profile" aria-selected="false" tabindex="-1" role="tab">Rejected
            Requests</a>
    </li>

    <div id="myTabContent" class="tab-content" style="width: 100%;">
        <div class="tab-pane fade show active" id="home" role="tabpanel">
            <div class="container mt-4">
                <div class="row">
                    <div class="col-12 mb-4" *ngFor="let artist of requestedArtists">
                        <div class="card request-card d-flex flex-row align-items-center" style="max-height: 115px;">
                            <div class="profile-pic">
                                <img [src]="artist.profile_photo_url" alt="Profile Picture" class="avatar-lg">
                            </div>
                            <div class="card-body d-flex flex-column flex-grow-1">
                                <div class="d-flex justify-content-between align-items-center">
                                    <div class="artist-info">
                                        <h5 class="card-title mb-0">{{ artist.fName }} {{ artist.LName }}</h5>
                                        <p class="card-text mb-0 text-muted">{{ artist.profession }} | {{ artist.location }}</p>
                                        <p class="card-text fw-medium mb-0">{{ artist.registered_at | date: 'yyyy-MM-dd' }}</p>
                                        <p class="text-primary fst-italic mb-0" (click)="openUserDetailsModal(artist.user_id)" style="cursor:pointer;">More Details</p>
                                    </div>
                                    <div class="d-flex flex-column justify-content-center">
                                        <button class="btn btn-success btn-sm mb-2" (click)="approveArtist(artist.user_id)">Approve</button>
                                        <button class="btn btn-danger btn-sm" (click)="rejectArtist(artist.user_id)">Reject</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="tab-pane fade" id="profile" role="tabpanel">
            <div class="container mt-4">
                <div class="row">
                    <div class="col-12 mb-4" *ngFor="let artist of rejectedArtists">
                        <div class="card request-card d-flex flex-row align-items-center" style="max-height: 115px;">
                            <div class="profile-pic">
                                <img [src]="artist.profile_photo_url" alt="Profile Picture" class="avatar-lg">
                            </div>
                            <div class="card-body d-flex flex-column flex-grow-1">
                                <div class="d-flex justify-content-between align-items-center">
                                    <div class="artist-info">
                                        <h5 class="card-title mb-0">{{ artist.fName }} {{ artist.LName }}</h5>
                                        <p class="card-text mb-0 text-muted">{{ artist.profession }} | {{ artist.location }}</p>
                                        <p class="card-text fw-medium mb-0">{{ artist.registered_at | date: 'yyyy-MM-dd' }}</p>
                                        <p class="text-primary fst-italic mb-0" (click)="openUserDetailsModal(artist.user_id)" style="cursor:pointer;">More Details</p>
                                    </div>
                                    <div class="d-flex flex-column justify-content-center">
                                        <button class="btn btn-success btn-sm mb-2" (click)="approveArtist(artist.user_id)">Approve</button>
                                        <button class="btn btn-danger btn-sm" (click)="openDeleteConfirm(artist)">Delete</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</ul>
  
  <app-modal id="modal-userDetails">
    <div class="new-modal">
      <div class="new-modal-body">
        <div class="modal-content" style="width: 50rem;">
          <div class="modal-header mb-4">
            <h5 class="modal-title border-bottom border-primary border-2">User Details</h5>
            <button type="button" class="btn-close" aria-label="Close" (click)="this.modalService.close('modal-userDetails')"></button>
          </div>
          <div class="modal-body">
            <div class="row">
              <div class="col-md-4">
                <div class="border border-dark-subtle p-3">
                  <h5 class="text-body-secondary">Profile Photo</h5>
                  <img [src]="selectedArtist.profile_photo_url" alt="Profile Photo" class="img-fluid mb-3" style="width: 250px; height: 100%">
                </div>
              </div>
              <div class="col-md-8">
                <div class="border border-dark-subtle p-3">
                  <h5 class="text-body-secondary">Basic Information</h5>
                  <ul class="list-group">
                    <li class="list-group-item"><strong>First Name:</strong> {{ selectedArtist.fName }}</li>
                    <li class="list-group-item"><strong>Last Name:</strong> {{ selectedArtist.LName }}</li>
                    <li class="list-group-item"><strong>Profession:</strong> {{ selectedArtist.profession }}</li>
                    <li class="list-group-item"><strong>Location:</strong> {{ selectedArtist.location }}</li>
                    <li class="list-group-item"><strong>Applied Date:</strong> {{ selectedArtist.registered_at | date: 'short' }}</li>
                  </ul>
                </div>
              </div>
            </div>
            <div class="border border-dark-subtle p-3 mt-4">
              <h5 class="text-body-secondary">On the Web</h5>
              <div class="row">
                <div class="col-md-12">
                  <ul class="list-group">
                    <li class="list-group-item" *ngFor="let socialLink of socialLinks">
                      <img [src]="socialLink.logo_url" alt="{{ socialLink.platform_name }}" class="img-fluid me-2" style="width: 20px;">
                      <a [href]="socialLink.account_url" target="_blank">{{ socialLink.account_url }}</a>
                    </li>
                  </ul>
                </div>
              </div>
            </div>
            <div class="border border-dark-subtle p-3 mt-4">
              <h5 class="text-body-secondary">Description</h5>
              <p style="max-height: 8rem; overflow-y: auto;">{{ selectedArtist.description }}</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </app-modal>
  
  <app-modal id="modal-deleteConfirm">
    <div class="modal-dialog">
        <div class="modal-content" style="width: 25rem;height:13rem;">
            <div class="modal-header d-flex justify-content-center">
                <h5 class="modal-title text-danger" id="confirmDeleteModalLabel">Confirm Deletion</h5>
            </div>
            <div class="d-flex justify-content-center">
                <img src="../../../../../assets/icons/warning-error-svgrepo-com.svg" alt="warning" style="width: 100px;">
            </div>
            <div class="modal-body m-2">
                Are you sure you want to delete this Artist Request?
            </div>
            <div class="modal-footer d-flex justify-content-between">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal"
                    (click)="this.modalService.close('modal-deleteConfirm')">Cancel</button>
                <button type="button" class="btn btn-danger"
                    (click)="deleteArtist(selectedArtist.user_id)">Delete</button>
            </div>
        </div>
    </div>
</app-modal>